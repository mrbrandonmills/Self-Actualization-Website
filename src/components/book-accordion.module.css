/**
 * BookAccordion Styles
 * Phase 4: Kasane-Style Scroll Explosion
 *
 * Fixed viewport stage with scroll-driven 3D animation
 */

/* ========================================
   CONTAINER (Scroll Spacer + Fixed Stage)
   ======================================== */

.bookAccordion {
  position: relative;
  background: linear-gradient(
    180deg,
    #05201f 0%,
    #0a2f2e 50%,
    #05201f 100%
  );
  overflow: hidden;
}

/* Scroll spacer (creates scroll distance, invisible) */
.scrollSpacer {
  position: relative;
  width: 100%;
  /* Height set via inline style (default: 500vh) */
}

/* ========================================
   FIXED STAGE (Viewport-Locked 3D Space)
   ======================================== */

.stage {
  /* Fixed to viewport */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;

  /* 3D perspective */
  perspective: 2000px;
  perspective-origin: 50% 50%;

  /* Don't block scrolling */
  pointer-events: none;

  /* Center everything */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ========================================
   PAGES CONTAINER (3D Transform Space)
   ======================================== */

.pagesContainer {
  position: relative;
  width: 600px;
  height: 800px;

  /* CRITICAL: Preserve 3D transforms */
  transform-style: preserve-3d;

  /* Center in viewport */
  /* Using flex from .stage */
}

/* Mobile responsive */
@media (max-width: 768px) {
  .pagesContainer {
    width: 300px;
    height: 400px;
  }
}

@media (min-width: 769px) and (max-width: 1024px) {
  .pagesContainer {
    width: 450px;
    height: 600px;
  }
}

/* ========================================
   INDIVIDUAL PAGE (3D Object)
   ======================================== */

.page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Preserve 3D for child faces */
  transform-style: preserve-3d;

  /* Initial position (stacked) */
  transform: translateZ(0);

  /* Smooth transitions */
  transition: transform 0.1s ease-out;

  /* GPU acceleration */
  will-change: transform;
}

/* ========================================
   PAGE FRONT FACE
   ======================================== */

.pageFront {
  position: absolute;
  width: 100%;
  height: 100%;

  /* Aged paper background */
  background: #f8f4e8;

  /* Rounded corners */
  border-radius: 2px;

  /* Shadow system (4 layers) */
  box-shadow:
    /* Ambient shadow */
    0 8px 16px rgba(0, 0, 0, 0.2),
    /* Direct shadow */
    0 16px 32px rgba(0, 0, 0, 0.25),
    /* Edge shadow (right) */
    inset -4px 0 12px rgba(0, 0, 0, 0.12),
    /* Highlight (top) */
    inset 0 2px 4px rgba(255, 255, 255, 0.15);

  /* Overflow for image */
  overflow: hidden;

  /* Position in 3D (slightly forward) */
  transform: translateZ(2px);

  /* Hide backface */
  backface-visibility: hidden;
}

.pageImage {
  object-fit: cover;
  object-position: center;
}

/* Page overlay for depth/texture */
.pageOverlay {
  position: absolute;
  inset: 0;

  /* Subtle gradient */
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.05) 0%,
    rgba(0, 0, 0, 0.03) 50%,
    rgba(0, 0, 0, 0.08) 100%
  );

  /* Mix blend for realism */
  mix-blend-mode: overlay;
  pointer-events: none;
}

/* ========================================
   PAGE EDGES (Thickness)
   ======================================== */

/* Right Edge (most visible) */
.pageEdgeRight {
  position: absolute;
  right: 0;
  top: 0;
  width: 3px;
  height: 100%;

  /* Gradient for depth */
  background: linear-gradient(
    to right,
    #e8e0cc 0%,
    #d8d0bc 50%,
    #c8c0ac 100%
  );

  /* Rotate 90deg to create edge */
  transform: rotateY(90deg) translateX(1.5px);
  transform-origin: right center;

  /* Shadow for realism */
  box-shadow:
    inset -1px 0 2px rgba(0, 0, 0, 0.15),
    inset 1px 0 2px rgba(0, 0, 0, 0.1);
}

/* Top Edge */
.pageEdgeTop {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;

  background: linear-gradient(
    to bottom,
    #f8f4e8 0%,
    #e8e0cc 50%,
    #d8d0bc 100%
  );

  transform: rotateX(90deg) translateY(-1.5px);
  transform-origin: top center;

  box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);
}

/* Bottom Edge */
.pageEdgeBottom {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;

  background: linear-gradient(
    to top,
    #f8f4e8 0%,
    #e8e0cc 50%,
    #d8d0bc 100%
  );

  transform: rotateX(-90deg) translateY(1.5px);
  transform-origin: bottom center;

  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* ========================================
   PAGE BACK FACE
   ======================================== */

.pageBack {
  position: absolute;
  width: 100%;
  height: 100%;

  /* Slightly darker aged paper */
  background: #e8e0cc;
  border-radius: 2px;

  /* Rotate 180deg */
  transform: rotateY(180deg) translateZ(-3px);

  /* Shadow */
  box-shadow:
    inset 4px 0 12px rgba(0, 0, 0, 0.12),
    inset 0 -2px 4px rgba(0, 0, 0, 0.08);

  backface-visibility: hidden;
}

/* ========================================
   PAGE DETAILS
   ======================================== */

/* Corner curl (bottom-right) */
.pageCorner {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 40px;
  height: 40px;

  /* Triangle gradient */
  background: linear-gradient(
    135deg,
    transparent 50%,
    rgba(0, 0, 0, 0.06) 50%
  );

  border-radius: 0 0 2px 0;
  transform: translateZ(3px);
  pointer-events: none;
}

/* Page number (bottom-center) */
.pageNumber {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%) translateZ(3px);

  /* Styling */
  font-size: 12px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.3);
  font-family: 'SF Mono', 'Courier New', monospace;
  letter-spacing: 1px;

  pointer-events: none;
}

/* ========================================
   SCROLL INDICATOR
   ======================================== */

.scrollIndicator {
  position: fixed;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);

  /* Styling */
  padding: 12px 24px;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(12px);
  border-radius: 24px;
  border: 1px solid rgba(255, 255, 255, 0.1);

  /* Typography */
  color: white;
  font-size: 14px;
  font-weight: 500;

  /* Above pages */
  z-index: 1000;
  pointer-events: none;
}

.scrollProgress span {
  color: #f59e0b;
  font-weight: 700;
}

/* ========================================
   PERFORMANCE OPTIMIZATIONS
   ======================================== */

/* Force GPU acceleration on all 3D elements */
.page,
.pageFront,
.pageBack,
.pageEdgeRight,
.pageEdgeTop,
.pageEdgeBottom {
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* ========================================
   REDUCED MOTION
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  .page {
    transition: none;
  }

  /* Simplify transforms */
  .stage {
    perspective: 1000px;
  }
}

/* ========================================
   MOBILE OPTIMIZATIONS
   ======================================== */

@media (max-width: 768px) {
  /* Reduce perspective on mobile */
  .stage {
    perspective: 1200px;
  }

  /* Smaller page edges */
  .pageEdgeRight,
  .pageEdgeTop,
  .pageEdgeBottom {
    width: 2px;
    height: 2px;
  }

  /* Smaller corner curl */
  .pageCorner {
    width: 30px;
    height: 30px;
  }

  /* Smaller page number */
  .pageNumber {
    font-size: 10px;
    bottom: 16px;
  }
}
